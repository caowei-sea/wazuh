# AWS CloudTrail Integration


|   |   |
|---|---|
| event.module | aws |

This integration processes logs from AWS CloudTrail.

## Compatibility

None

## Configuration

Add to the ossec.conf file in the monitored agent the following configuration block to enable the integration with CloudTrail:
```xml
<wodle name="aws-s3">
  <disabled>no</disabled>
  <interval>10m</interval>
  <run_on_start>yes</run_on_start>
  <skip_on_error>yes</skip_on_error>
  <bucket type="cloudtrail">
    <name>wazuh-cloudtrail</name>
    <aws_profile>default</aws_profile>
  </bucket>
</wodle>
```


## Schema

| Field | Description | Type |
|---|---|---|
| aws.cloudtrail.additional_eventdata | Additional data about the event that was not part of the request or response. | keyword |
| aws.cloudtrail.api_version | Identifies the API version associated with the AwsApiCall eventType value. | keyword |
| aws.cloudtrail.digest.end_time | The ending UTC time range that the digest file covers, taking as a reference the time in which log files have been delivered by CloudTrail. | date |
| aws.cloudtrail.digest.log_files | A list of Logfiles contained in the digest. | keyword |
| aws.cloudtrail.digest.newest_event_time | The UTC time of the most recent event among all of the events in the log files in the digest. | date |
| aws.cloudtrail.digest.oldest_event_time | The UTC time of the oldest event among all of the events in the log files in the digest. | date |
| aws.cloudtrail.digest.previous_hash_algorithm | The name of the hash algorithm that was used to hash the previous digest file. | keyword |
| aws.cloudtrail.digest.previous_s3_bucket | The Amazon S3 bucket to which the previous digest file was delivered. | keyword |
| aws.cloudtrail.digest.public_key_fingerprint | The hexadecimal encoded fingerprint of the public key that matches the private key used to sign this digest file. | keyword |
| aws.cloudtrail.digest.s3_bucket |  | keyword |
| aws.cloudtrail.digest.signature_algorithm | The name of the Amazon S3 bucket to which the current digest file has been delivered. | keyword |
| aws.cloudtrail.digest.start_time | The starting UTC time range that the digest file covers, taking as a reference the time in which log files have been delivered by CloudTrail. | keyword |
| aws.cloudtrail.error_code | The AWS service error if the request returns an error. | keyword |
| aws.cloudtrail.error_message | If the request returns an error, the description of the error. | keyword |
| aws.cloudtrail.event_category | Shows the event category that is used in LookupEvents calls. For management events, the value is management. For data events, the value is data. For Insights events, the value is insight. | keyword |
| aws.cloudtrail.event_type | Identifies the type of event that generated the event record. | keyword |
| aws.cloudtrail.event_version | The CloudTrail version of the log event format. | keyword |
| aws.cloudtrail.flattened.request_parameters | The parameters, if any, that were sent with the request. | object |
| aws.cloudtrail.flattened.response_elements | The response element for actions that make changes (create, update, or delete actions). | object |
| aws.cloudtrail.flattened.service_event_details | Identifies the service event, including what triggered the event and the result. | object |
| aws.cloudtrail.management_event | A Boolean value that identifies whether the event is a management event. | keyword |
| aws.cloudtrail.read_only | Identifies whether this operation is a read-only operation. | keyword |
| aws.cloudtrail.recipient_account_id | Represents the account ID that received this event. | keyword |
| aws.cloudtrail.request_id | The value that identifies the request. The service being called generates this value. | keyword |
| aws.cloudtrail.resources.account_id | Account ID of the resource owner | keyword |
| aws.cloudtrail.resources.arn | Resource ARNs | keyword |
| aws.cloudtrail.resources.type | Resource type identifier in the format: AWS::aws-service-name::data-type-name | keyword |
| aws.cloudtrail.response_elements | The response element for actions that make changes (create, update, or delete actions). | keyword |
| aws.cloudtrail.service_event_details | Identifies the service event, including what triggered the event and the result. | keyword |
| aws.cloudtrail.shared_event_id | GUID generated by CloudTrail to uniquely identify CloudTrail events from the same AWS action that is sent to different AWS accounts. | keyword |
| aws.cloudtrail.user_identity.access_key_id | The access key ID that was used to sign the request. | keyword |
| aws.cloudtrail.user_identity.arn | The Amazon Resource Name (ARN) of the principal that made the call. | keyword |
| aws.cloudtrail.user_identity.invoked_by | The name of the AWS service that made the request, such as Amazon EC2 Auto Scaling or AWS Elastic Beanstalk. | keyword |
| aws.cloudtrail.user_identity.session_context.creation_date | The date and time when the temporary security credentials were issued. | date |
| aws.cloudtrail.user_identity.session_context.mfa_authenticated | The value is true if the root user or IAM user whose credentials were used for the request also was authenticated with an MFA device; otherwise, false. | keyword |
| aws.cloudtrail.user_identity.session_context.session_issuer.account_id | The account that owns the entity that was used to get credentials. | keyword |
| aws.cloudtrail.user_identity.session_context.session_issuer.arn | The ARN of the source (account, IAM user, or role) that was used to get temporary security credentials. | keyword |
| aws.cloudtrail.user_identity.session_context.session_issuer.principal_id | The internal ID of the entity that was used to get credentials. | keyword |
| aws.cloudtrail.user_identity.session_context.session_issuer.type | The source of the temporary security credentials, such as Root, IAMUser, or Role. | keyword |
| aws.cloudtrail.user_identity.type | The type of the identity | keyword |
| aws.cloudtrail.vpc_endpoint_id | Identifies the VPC endpoint in which requests were made from a VPC to another AWS service, such as Amazon S3. | keyword |
| aws.cloudtrail.flattened.additional_eventdata | Additional data about the event that was not part of the request or response. | object |
| aws.cloudtrail.console_login.login_to | URL for ConsoleLogin | keyword |
| aws.cloudtrail.console_login.mfa_used | Identifies whether multi factor authentication was used during ConsoleLogin | boolean |
| aws.cloudtrail.console_login.mobile_version | Identifies whether ConsoleLogin was from mobile version | boolean |
| aws.cloudtrail.insight_details | Shows information about the underlying triggers of an Insights event, such as event source, user agent, statistics, API name, and whether the event is the start or end of the Insights event. | keyword |
| aws.cloudtrail.request_parameters | The parameters, if any, that were sent with the request. | keyword |
## Decoders

| Name | Description |
|---|---|
| decoder/aws-cloudtrail/0 | Decoder for wazuh integration of AWS CloudTrail Logs |
## Changelog

| Version | Description | Details |
|---|---|---|
| 1.0.0-dev | Created integration for AWS CloudTrail | [#16766](#) |
