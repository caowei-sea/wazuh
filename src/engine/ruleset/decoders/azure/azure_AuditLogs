
name: decoder/azure_AuditLogs/0

sources: 
  - decoder/azure_base_decoder/0

metadata:
  description: AuditLog decoder for Azure events
  module: Azure
  compatibility: >
    This decoder has been tested on Wazuh version 4.3
  author:
    name: Wazuh, Inc.
    date: 2023/02/01
  title: This decoder normalizes basic field from Azure AuditLogs
  references:
    - https://learn.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs

check:
   - ~json.category: AuditLogs

normalize:
  - map:
     - azure.auditlogs.properties.operation_type: $~json.operationType
     - azure.auditlogs.properties.activity_display_name: $~json.activityDisplayName
     - azure.auditlogs.properties.activity_datetime: $~json.activityDateTime
     - azure.auditlogs.properties.additional_details: $~json.additionalDetails
     - azure.auditlogs.properties.result_reason: $~json.resultReason
     - azure.auditlogs.properties.correlation_id: $~json.correlationId
     - azure.auditlogs.properties.logged_by_service: $~json.loggedByService
     - azure.auditlogs.properties.target_resources: $~json.targetResources